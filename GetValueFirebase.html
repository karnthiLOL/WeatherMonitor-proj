<html>

    <head>
        

        <meta charset="utf-8">
        <title>รับค่าจาก Firebase Real-time database</title>


        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.5.8/angular.js"></script>
        <script src="https://www.gstatic.com/firebasejs/3.4.0/firebase.js"></script>
        <script>
            // สร้างตัวแปรเก็บค่าset
            var setDO = {};
            
            angular.module('firebaseApp', []).service('firebaseService', function() {
                // สร้าง Function เพื่อ init Firebase เข้ากับ app เรา
                this.initFirebase = function() {
                    var config = {
                        apiKey: "AIzaSyDoVJBqdSkgE6IJbvyS_lBnOJdRj0U9ypk",
                        authDomain: "wealthy-a83a5.firebaseapp.com",
                        databaseURL: "https://wealthy-a83a5-default-rtdb.firebaseio.com"
                    };
                    

                    //อ้างอิงข้อมูลDatabase
                    firebase.initializeApp(config);
                    setDO = firebase.database().ref("Set")

                }
                // สร้าง Function เพื่อเก็บ event ของ Firebase
                

                this.eventFirebase = function() {

                    setDO.on('value',function(data){
                        const datas = Object.values(data.val());
                        const show = datas[0]
                        console.log(datas)
                        console.log(show)
                         document.getElementById('DO').innerHTML =" Air Quality Index : " + show + " AQI ";
                        guage0.refresh(show);

                        // const EpochTime = datas[1]
                        // console.log(EpochTime)
                        // document.getElementById('Epoch').innerHTML =" EpochTime : " + EpochTime + "sec";
                        // guage1.refresh(EpochTime);

                        const Humidity = datas[2]
                        console.log(Humidity)
                        document.getElementById('Hum').innerHTML =" Humidity : " + Humidity + " %";
                        guage2.refresh(Humidity);

                        const temperature = datas[3]
                        console.log(temperature)
                        document.getElementById('Tem').innerHTML =" temperature : " + temperature + " องศา";
                        guage3.refresh(temperature);


                        
                        // const tempureter = datas[4]
                        // console.log(tempureter)
                        // document.getElementById('temp').innerHTML =" Tempureter : " + tempureter + "C";
                        // guage4.refresh(tempureter);

                    })
                }
                this.push = function(title, content) {}
            }).controller('firebaseCtrl', function(firebaseService) {
                // เรียกใช้งาน firebaseService ที่เราสร้างไว้
                firebaseService.initFirebase();
                firebaseService.eventFirebase();
            })
        </script>
        
    </head>

     <style>
        h5 {
          font-size: 30px;
        }
     </style>
    <body ng-app="firebaseApp">
        <div ng-controller="firebaseCtrl" >
            <h5 id="DO" align="right">Air Quality Index</h5>
            <div id = "guage0" style="width:30%"></div>
            <!-- <h5 id="Epoch" align="right">EpochTime</h5>
            <div id = "guage1" style="width:30%;"></div> -->
            <h5 id="Hum" align="right">Humidity</h5>
            <div id = "guage2" style="width:30%;"></div>
            <h5  id='Tem' align="right">temperature</h5>
            <div id = "guage3" style="width:30%;"></div>
        </div>

        <script src="raphael-2.1.4.min.js"></script>
        <script src="justgage.js"></script>     
        <script>
        var guage0; 
            guage0 = new JustGage({
                        id: "guage0",
                        title: "Air Quality Index",
                        value: 1,
                        min: 0,
                        max: 100,
                        gaugeWidthScale: 0.7,
                        counter: true,
                        titleFontColor: "#000",
                        titleFontFamily: "Georgia",
                        titlePosition: "below",
                        valueFontColor: "#505050",
                        valueFontFamily: "Georgia",
                        titleFontFamily: "Vollkorn",
                    });
        // var guage1; 
        //     guage1 = new JustGage({
        //                 id: "guage1",
        //                 title: "EpochTime",
        //                 value: 1,
        //                 min: 0,
        //                 max: 10000000000,
        //                 gaugeWidthScale: 0.7,
        //                 counter: true,
        //                 titleFontColor: "#000",
        //                 titleFontFamily: "Georgia",
        //                 titlePosition: "below",
        //                 valueFontColor: "#505050",
        //                 valueFontFamily: "Georgia",
        //                 titleFontFamily: "Vollkorn",
        //                 });

            var guage2; 
            guage2 = new JustGage({
                        id: "guage2",
                        title: "Humidity",
                        value: 1,
                        min: 0,
                        max: 100,
                        gaugeWidthScale: 0.7,
                        counter: true,
                        titleFontColor: "#000",
                        titleFontFamily: "Georgia",
                        titlePosition: "below",
                        valueFontColor: "#505050",
                        valueFontFamily: "Georgia",
                        titleFontFamily: "Vollkorn",
                        });
            var guage3; 
            guage3 = new JustGage({
                        id: "guage3",
                        title: "temperature",
                        value: 1,
                        min: 0,
                        max: 60,
                        gaugeWidthScale: 0.7,
                        counter: true,
                        titleFontColor: "#000",
                        titleFontFamily: "Georgia",
                        titlePosition: "below",
                        valueFontColor: "#505050",
                        valueFontFamily: "Georgia",
                        titleFontFamily: "Vollkorn",
                        });

                        
        </script>
    </body>


</html>